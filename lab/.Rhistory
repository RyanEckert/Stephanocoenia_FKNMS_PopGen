panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_segment(data = subset(snpPca, subset = c("Banco de San Antonio", "Isla de la Juventud") %in% snpPca$site), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_segment(data = subset(snpPca, subset = snpPca$site %in% c("Banco de San Antonio", "Isla de la Juventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_segment(data = subset(snpPca, subset = site %in% c("Banco de San Antonio", "Isla de la Juventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
snpPca
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "Isla delaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
ordiellipse(type = "t", geom = "polygon", alpha = 0.1) +
ordiellipse(type = "t") +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(type = "t", geom = "polygon", alpha = 0.1) +
stat_ellipse(type = "t") +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(snpPca, subset != site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) +
stat_ellipse(data = subset(snpPca, subset != site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t") +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(snpPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) +
stat_ellipse(data = subset(snpPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t") +
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaSnpPcaPlotA = ggplot(snpPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(snpPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) +
#  stat_ellipse(data = subset(snpPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t") + ellipse
geom_segment(data = subset(snpPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(shape = 19, size = 3) + #individual's points indicated by circles
geom_point(aes(x = mean.x, y = mean.y, shape = depth), size = 4, color = "black") + #population centroids indicated by triangles
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", snpPcVar[1],"%)", sep = "")) + #Prints percent variation explained by first axis
ylab(paste ("PC 2 (", snpPcVar[2],"%)", sep = "")) + #Prints percent variation explained by second axis
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcaPlot = cubaSnpPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcaPlot
cubaMsat = read.genalex("cuba_trimmed_microsats_genalex.csv", genclone = FALSE)
xMsat = tab(cubaMsat, freq = TRUE, NA.method = "mean")
mSatPca1 = dudi.pca(xMsat, center = TRUE, scale = FALSE, scannf = FALSE, nf = 77)
mSatPcaValues = as.data.frame(mSatPca1$li)
mSatPca = data.frame(row.names = rownames(mSatPcaValues), sample = rownames(mSatPcaValues),
site = as.factor(popData$population), depth = popData$depth,
PC1 = mSatPcaValues[,1], PC2 = mSatPcaValues[,2])
# percentage of explained variance by axes
mSatPcVar = round(mSatPca1$eig/sum(mSatPca1$eig)*100, 1)
mSatPcVar
# merge centroid locations into ggplot dataframe
mSatPca = merge(mSatPca, aggregate(cbind(mean.x = PC1, mean.y = PC2) ~ site, mSatPca, mean), by = "site")
# construct PCA biplot
cubaMsatPcaPlotA = ggplot(data = mSatPca, aes(x = PC1, y = PC2)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(mSatPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) + #ellipse
geom_segment(data = subset(mSatPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
#geom_segment(aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(data = mSatPca, aes(x = PC1, y = PC2, color = site), shape = 19, size = 3) + #individuals
geom_point(data = mSatPca, aes(x = mean.x, y = mean.y, shape = depth, fill = site), size = 4, color = "black") + #centroids
scale_shape_manual(values = c(24, 25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", mSatPcVar[1],"%)", sep = "")) +
ylab(paste ("PC 2 (", mSatPcVar[2],"%)", sep = "")) +
guides(fill = guide_legend(override.aes = list(size = 4, shape = 22, color = NA), order = 1))+
ggtitle("Microsatellite") +
theme_bw()
cubaMsatPcaPlot = cubaMsatPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaMsatPcaPlot
mSatPca
mSatPca
# construct PCA biplot
cubaMsatPcaPlotA = ggplot(data = mSatPca, aes(x = PC1, y = PC2)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(mSatPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) + #ellipse
geom_segment(data = subset(mSatPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
#geom_segment(aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(data = mSatPca, aes(x = PC1, y = PC2, color = site), shape = 19, size = 3) + #individuals
geom_point(data = mSatPca, aes(x = mean.x, y = mean.y, shape = depth, fill = site), size = 4, color = "black") + #centroids
scale_shape_manual(values = c(24, 25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", mSatPcVar[1],"%)", sep = "")) +
ylab(paste ("PC 2 (", mSatPcVar[2],"%)", sep = "")) +
guides(fill = guide_legend(override.aes = list(size = 4, shape = 22, color = NA), order = 1))+
ggtitle("Microsatellite") +
theme_bw()
cubaMsatPcaPlot = cubaMsatPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaMsatPcaPlot
# construct PCA biplot
cubaMsatPcaPlotA = ggplot(data = mSatPca, aes(x = PC1, y = PC2, color = site, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
stat_ellipse(data = subset(mSatPca, subset = !site %in% c("BancodeSanAntonio", "IsladelaJuventud")), type = "t", geom = "polygon", alpha = 0.1) + #ellipse
geom_segment(data = subset(mSatPca, subset = site %in% c("BancodeSanAntonio", "IsladelaJuventud")), aes(xend = mean.x, yend = mean.y, color = site)) + #spider
#geom_segment(aes(xend = mean.x, yend = mean.y, color = site)) + #spider
geom_point(data = mSatPca, aes(x = PC1, y = PC2, color = site), shape = 19, size = 3) + #individuals
geom_point(data = mSatPca, aes(x = mean.x, y = mean.y, shape = depth, fill = site), size = 4, color = "black") + #centroids
scale_shape_manual(values = c(24, 25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
scale_color_manual(values = brewer.pal(name = "Dark2", n = 8), name = " Population", labels = plotPops) +
xlab(paste ("PC 1 (", mSatPcVar[1],"%)", sep = "")) +
ylab(paste ("PC 2 (", mSatPcVar[2],"%)", sep = "")) +
guides(fill = guide_legend(override.aes = list(size = 4, shape = 22, color = NA), order = 1))+
ggtitle("Microsatellite") +
theme_bw()
cubaMsatPcaPlot = cubaMsatPcaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaMsatPcaPlot
cubaMsatPcoa = read.csv("cubaMsatPcoa.csv", header = TRUE, check.names = FALSE)
cubaMsatPcoaPlotA = ggplot(cubaMsatPcoa, aes(x = PCo1, y = PCo2, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_point(size = 4) +
scale_shape_manual(values = c(25,24), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = "Population", labels = plotPops) +
xlab("PCo 1 (58.0%)") +
ylab("PCo 2 (14.1%)") +
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA)))+
ggtitle("Microsatellite") +
theme_bw()
cubaMsatPcoaPlot = cubaMsatPcoaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaMsatPcoaPlot
#First calculate Nei's genetic distance using the program STAMPP
cubaSnpDpop = stamppNeisD(cubaGenlight, pop = TRUE) # Nei's 1972 distance between pops
#First calculate Nei's genetic distance using the program STAMPP
cubaSnpDpop = stamppNeisD(cubaGenlight, pop = TRUE) # Nei's 1972 distance between pops
# This is the actual PCoA step; you can use any distance matrix here (euclidean = PCA),
# We are using Nei's genetic distance
cubaMds = cmdscale(cubaSnpDpop, eig = TRUE, x.ret = TRUE)
# Determine percent variation captured on each axis
# Calculate the eigenvalues so later we can figure out % variation shown on each Principal Coordinate
cubaSnpPcoaVar = round(cubaMds$eig/sum(cubaMds$eig)*100, 1)
cubaSnpPcoaVar
# Format data to plot
cubaSnpPcoaValues = cubaMds$points
cubaSnpPcoaValues =as.data.frame(cubaSnpPcoaValues, sample = rownames(cubaSnpPcoaValues))
cubaSnpPcoa = data.frame(site = rownames(cubaSnpPcoaValues),
depth = factor(c("Mesophotic","Shallow","Shallow","Shallow","Shallow","Shallow","Shallow","Shallow"),
levels=c("Shallow","Mesophotic")),
PCo1 = cubaSnpPcoaValues[,1], PCo2 = cubaSnpPcoaValues[,2])
# SNP PCoA biplot
cubaSnpPcoaPlotA = ggplot(cubaSnpPcoa, aes(x = PCo1, y = PCo2, fill = site, shape = depth)) +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_point(size = 4) +
scale_y_reverse() +
scale_shape_manual(values = c(24,25), name = "Depth") +
scale_fill_manual(values = brewer.pal(name = "Dark2", n = 8), name = "Population", labels = plotPops) +
xlab(paste ("PCo 1 (", cubaSnpPcoaVar[1],"%)", sep = "")) +
ylab(paste ("PCo 2 (", cubaSnpPcoaVar[2],"%)", sep = "")) +
guides(fill = guide_legend(override.aes = list(shape = 22, size = 4, color = NA), order = 1))+
ggtitle("SNP") +
theme_bw()
cubaSnpPcoaPlot = cubaSnpPcoaPlotA +
theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "left",
legend.title = element_text(color = "black", size = 10),
legend.text = element_text(color = "black", size = 10),
legend.key = element_blank(),
panel.border = element_rect(color = "black", size = 1.2),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cubaSnpPcoaPlot
cubaOrdPlots = (cubaMsatPcoaPlot|cubaMsatPcaPlot)/(cubaSnpPcoaPlot|cubaSnpPcaPlot) +
plot_layout(guides = 'collect') +
plot_annotation(tag_level = "a") &
theme(plot.tag = element_text(size = 14, face = "bold"))
cubaOrdPlots
cubaOrdPlots
ggsave("../figures/Figure5alt.eps", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
cubaOrdPlots
ggsave("../figures/Figure5alt.eps", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
ggsave("../figures/Figure5alt.png", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
cubaOrdPlots
ggsave("../figures/Figure5alt.eps", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
ggsave("../figures/Figure5alt.png", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
ggsave("../figures/Figure5alt.tiff", plot = cubaOrdPlots, height = 20, width = 25, unit = "cm", dpi = 300)
library("tidyverse")
setwd("~/Documents/GitHub/FKNMS/lab/")
samples = read.csv("samples.csv")
### Xestospongia
xestoSamples = samples %>% group_by(species, region, depthZone) %>% filter(species == "Xestospongia muta") %>%
add_count()
xestoLow = xestoSamples %>% filter(n < 30) %>% as.data.frame()
set.seed(694)
xestoSubset = xestoSamples %>% filter(n >= 30) %>% sample_n(30) %>% as.data.frame() %>% add_row(xestoLow) %>%
arrange(sampleID) %>% add_column(tubeID = paste("X", sprintf("%03s", rownames(.)), sep = ""), .after = "sampleID") %>%
group_by(region, depthZone) %>% add_count() %>% as.data.frame()
#### Save .csv of subset
write.csv(xestoSubset, "fknmsXestoSubset.csv")
### Stepahnocoenia
sintSamples = samples %>% group_by(species, region, depthZone) %>% filter(species == "Stephanocoenia intersepta") %>%
add_count()
sintLow = sintSamples %>% filter(n < 30) %>% as.data.frame()
set.seed(694)
sintSubset = sintSamples %>% filter(n >= 30) %>% sample_n(30) %>% as.data.frame() %>% add_row(sintLow) %>%
arrange(sampleID) %>% add_column(tubeID = paste("S", sprintf("%03s", rownames(.)), sep = ""), .after = "sampleID") %>%
group_by(region, depthZone) %>% add_count() %>% as.data.frame()
#### Save .csv of subset
write.csv(sintSubset, "fknmsStephanocoeniaSubset.csv")
### Create one large file of species subsets
fknmsSampleSubset = xestoSubset %>% add_row(sintSubset)
write.csv(fknmsSampleSubset, "fknmsSubset.csv")
